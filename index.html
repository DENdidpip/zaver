<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tangram</title>
  
  <!-- PWA Meta Tags -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#3498db">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Tangram">
  
  <link href = "styles/index.css" rel = "stylesheet">
  <style>
    @keyframes winPulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    #message {
      text-align: center;

      transition: all 0.3s ease;
    }
    
    #board {
      transition: border 0.3s ease, box-shadow 0.3s ease;
    }
    
    .level-panel {
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      padding: 15px;
      margin: 15px 0;
      text-align: center;
    }
    
    .level-btn {
      background: #3498db;
      color: white;
      border: none;
      padding: 10px 15px;
      margin: 5px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s ease;
    }
    
    .level-btn:hover {
      background: #2980b9;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    
    .level-btn.active {
      background: #e74c3c;
      font-weight: bold;
    }
    
    .level-btn:disabled {
      background: #bdc3c7;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .nav-btn {
      background: #27ae60;
      color: white;
      border: none;
      padding: 8px 15px;
      margin: 0 10px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.2s ease;
    }
    
    .nav-btn:hover:not(:disabled) {
      background: #219a52;
      transform: translateY(-2px);
    }
    
    .nav-btn:disabled {
      background: #95a5a6;
      cursor: not-allowed;
      transform: none;
    }
    
    .menu-btn:hover {
      background: #8e44ad !important;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(155, 89, 182, 0.3);
    }
  </style>
</head>
<body>

<div style="text-align: center; margin-bottom: 15px;">
  <a href="menu.html" class="menu-btn" style="background: #9b59b6; color: white; text-decoration: none; padding: 10px 20px; border-radius: 25px; font-size: 14px; display: inline-block; transition: all 0.3s ease;">
    Hlavn√© menu
  </a>
</div>

<h1>Tangram</h1>

<!-- –ü–∞–Ω–µ–ª—å –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω–µ–π -->
<div class="level-panel">
  <h3 style="margin-top: 0; color: #2c3e50;">V√Ωber √∫rovne</h3>
  <div id="levelButtons">
    <!-- –ö–Ω–æ–ø–∫–∏ —É—Ä–æ–≤–Ω–µ–π –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
  </div>
  <div style="margin-top: 10px;">
    <button id="prevLevel" onclick="previousLevel()" class="nav-btn">‚Üê Predch√°dzaj√∫ca</button>
    <span style="font-weight: bold; margin: 0 15px; font-size: 18px;">
      √örove≈à <span id="currentLevelNumber">1</span>: <span id="currentLevelName">Square</span>
    </span>
    <button id="nextLevel" onclick="nextLevel()" class="nav-btn">Nasleduj√∫ca ‚Üí</button>
  </div>
</div>

<canvas id="board" width="600" height="700"></canvas>

<div style="text-align: center; margin: 10px 0;">
  <div style="display: inline-block; background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 10px; padding: 10px; margin: 0 10px;">
    <span style="font-weight: bold; color: #2c3e50;">Aktu√°lny ƒças: </span>
    <span id="currentTime" style="font-size: 18px; font-weight: bold; color: #e74c3c;">00:00</span>
  </div>
  <div style="display: inline-block; background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 10px; padding: 10px; margin: 0 10px;">
    <span style="font-weight: bold; color: #2c3e50;">Najlep≈°√≠ ƒças: </span>
    <span id="bestTime" style="font-size: 18px; font-weight: bold; color: #27ae60;">--:--</span>
  </div>
  <button onclick="resetTimer()" style="padding: 8px 15px; margin-left: 10px; font-size: 14px; background: #f39c12; color: white; border: none; border-radius: 5px; cursor: pointer;">üîÑ Re≈°tart</button>
</div>

<p id="message" style="font-weight:bold"></p>

<p>
  <span id="workerStatus" style="margin-left:12px;font-weight:bold">Worker: ‚Äî</span>
</p>
<p id="testResults" style="white-space:pre-wrap;font-family:monospace;margin-top:8px;"></p>

<p style="color:#555">Pres√∫vanie: podr≈æte a ≈•ahajte. Klik prav√Ωm tlaƒçidlom: otoƒçi≈• o 45¬∞. Dvojit√© kliknutie: otoƒçi≈• o 90¬∞.</p>

<div style="margin: 10px 0; text-align: center;">
  <label for="tolerance" style="margin-right: 10px;">Tolerancia pre v√≠≈•azstvo (pixelov):</label>
  <input type="number" id="tolerance" value="1000" min="0" max="5000" step="100" style="width: 80px; padding: 5px; margin-right: 10px;">
  <button onclick="checkWinCondition()" style="padding: 10px 20px; font-size: 16px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">üîç Skontrolova≈• v√≠≈•azstvo</button>
</div>

<script src = "src/index.js"></script>

<script>
// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker –¥–ª—è PWA
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js')
      .then(registration => {
        console.log('SW –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ:', registration.scope);
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
        registration.addEventListener('updatefound', () => {
          const newWorker = registration.installing;
          newWorker.addEventListener('statechange', () => {
            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
              // –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞
              if (confirm('Dostupn√° je nov√° verzia hry. Aktualizova≈•?')) {
                newWorker.postMessage({ type: 'SKIP_WAITING' });
                window.location.reload();
              }
            }
          });
        });
      })
      .catch(error => {
        console.log('SW —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å:', error);
      });
  });
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PWA
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  
  // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  console.log('PWA –≥–æ—Ç–æ–≤–∞ –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ');
});

window.addEventListener('appinstalled', (evt) => {
  console.log('PWA —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
});
</script>

</body>
</html>
